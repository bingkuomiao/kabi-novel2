<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">
<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="
        width=device-width,
        initial-scale=1.0,
        minimum-scale=1.0,
        maximum-scale=1.0,
        user-scalable=no">
    <title>kabi novel</title>
    <!-- inject:css -->
    <style>.page,body,html{position:relative;width:100%}body,html{height:100%;overflow:hidden;margin:0;padding:0;background-color:#fff;font-size:20px;line-height:24px}body *,html *{box-sizing:border-box}body .button,html .button{min-width:150px;padding:0 10px;font-size:60px;display:inline-block;border:1px solid #333;text-align:center;justify-content:center}.page{height:100%;display:none}.page.show{display:block}.page .content{padding:10px}.page .content .pagination-box{height:100%;overflow:hidden}.page .content .pagination-box .pagination-body{min-height:100%}.page .bar{height:50px;position:absolute;bottom:180px;width:100%;background-color:#666;text-align:center}.page .bar .bar-progress{display:inline-block;height:100%;background-color:#000;float:left}.page .bar .bar-text{position:absolute;width:100%;height:100%;line-height:50px;color:#fff}.page .control{height:180px;background-color:#eee;position:absolute;bottom:0;width:100%;padding-top:20px}.page .control .left-box{float:left}.config .content .right,.page .control .right-box{float:right}.page .control .button{line-height:160px;height:100%;margin:0 10px}.catalogue .article-list{font-size:0}.catalogue .article-list .article-item{display:inline-block;width:50%;font-size:40px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;vertical-align:middle}.bookshelf .book-list{font-size:0}.bookshelf .book-list .book-item{display:inline-block;width:50%;padding:10px;min-height:200px;vertical-align:middle;font-size:24px;line-height:40px;margin:0}.bookshelf .book-list .book-item .book-cover{display:inline-block;height:100%;border:1px solid #ccc;background-size:100%;background-position:center;vertical-align:middle}.bookshelf .book-list .book-item .book-cover img{width:100%;height:100%}.bookshelf .book-list .book-item .book-info{display:inline-block;height:100%;padding:10px;vertical-align:middle}.bookshelf .book-list .book-item .book-info>div{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.bookshelf .book-list .book-item .book-info>div:first-child{font-size:32px;font-weight:700}.config .content{padding:20px 40px;font-size:30px;line-height:40px;height:100%}.config .content .button{margin-left:10px}.config .form-item{padding:10px 0}.config .form-item .label::after{content:"："}.config .form-item .text{line-height:60px}.config .form-item .text input{font-size:50px;line-height:60px;width:70%}.config .form-item.display .text{height:500px;border:1px solid #333;padding:10px;line-height:20px;font-size:16px;overflow:hidden}.config .form-item.display .text p{margin:0;text-indent:2em}.modal-box .modal{position:absolute;min-width:600px;min-height:600px;left:50%;top:50%;margin-left:-300px;margin-top:-300px;border:1px solid #ccc;background-color:#fff}.modal-box .modal .modal-content{height:500px;padding:10px;word-break:break-all}.modal-box .modal .modal-footer{height:100px;text-align:center;border-top:1px solid #ccc;line-height:100px}.modal-box .modal .modal-footer .button{height:90px;margin:0 20px;vertical-align:middle;line-height:90px}.message-box{position:fixed;top:0;left:0;right:0}.message-box .message{text-align:center;padding:5px}.message-box .message .message-content{display:inline-block;height:60px;background-color:#666;font-size:50px;line-height:60px;color:#fff;border-radius:8px}</style>
    <!-- endinject -->
    <!-- inject:js -->
    <script>!function n(i,r,a){function s(e,t){if(!r[e]){if(!i[e]){var o="function"==typeof require&&require;if(!t&&o)return o(e,!0);if(c)return c(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}o=r[e]={exports:{}},i[e][0].call(o.exports,function(t){return s(i[e][1][t]||t)},o,o.exports,n,i,r,a)}return r[e].exports}for(var c="function"==typeof require&&require,t=0;t<a.length;t++)s(a[t]);return s}({1:[function(t,e,o){w=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};var w,n,i,r,a,s=a={compressToBase64:function(t){if(null==t)return"";var e=a._compress(t,6,function(t){return n.charAt(t)});switch(e.length%4){default:case 0:return e;case 1:return e+"===";case 2:return e+"==";case 3:return e+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:a._decompress(e.length,32,function(t){return c(n,e.charAt(t))})},compressToUTF16:function(t){return null==t?"":a._compress(t,15,function(t){return w(t+32)})+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:a._decompress(e.length,16384,function(t){return e.charCodeAt(t)-32})},compressToUint8Array:function(t){for(var e=a.compress(t),o=new Uint8Array(2*e.length),n=0,i=e.length;n<i;n++){var r=e.charCodeAt(n);o[2*n]=r>>>8,o[2*n+1]=r%256}return o},decompressFromUint8Array:function(t){if(null==t)return a.decompress(t);for(var e=new Array(t.length/2),o=0,n=e.length;o<n;o++)e[o]=256*t[2*o]+t[2*o+1];var i=[];return e.forEach(function(t){i.push(w(t))}),a.decompress(i.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":a._compress(t,6,function(t){return i.charAt(t)})},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),a._decompress(e.length,32,function(t){return c(i,e.charAt(t))}))},compress:function(t){return a._compress(t,16,function(t){return w(t)})},_compress:function(t,e,o){if(null==t)return"";for(var n,i,r,a,s={},c={},l="",u=2,d=3,h=2,p=[],f=0,g=0,m=0;m<t.length;m+=1)if(r=t.charAt(m),Object.prototype.hasOwnProperty.call(s,r)||(s[r]=d++,c[r]=!0),a=l+r,Object.prototype.hasOwnProperty.call(s,a))l=a;else{if(Object.prototype.hasOwnProperty.call(c,l)){if(l.charCodeAt(0)<256){for(n=0;n<h;n++)f<<=1,g==e-1?(g=0,p.push(o(f)),f=0):g++;for(i=l.charCodeAt(0),n=0;n<8;n++)f=f<<1|1&i,g==e-1?(g=0,p.push(o(f)),f=0):g++,i>>=1}else{for(i=1,n=0;n<h;n++)f=f<<1|i,g==e-1?(g=0,p.push(o(f)),f=0):g++,i=0;for(i=l.charCodeAt(0),n=0;n<16;n++)f=f<<1|1&i,g==e-1?(g=0,p.push(o(f)),f=0):g++,i>>=1}0==--u&&(u=Math.pow(2,h),h++),delete c[l]}else for(i=s[l],n=0;n<h;n++)f=f<<1|1&i,g==e-1?(g=0,p.push(o(f)),f=0):g++,i>>=1;0==--u&&(u=Math.pow(2,h),h++),s[a]=d++,l=String(r)}if(""!==l){if(Object.prototype.hasOwnProperty.call(c,l)){if(l.charCodeAt(0)<256){for(n=0;n<h;n++)f<<=1,g==e-1?(g=0,p.push(o(f)),f=0):g++;for(i=l.charCodeAt(0),n=0;n<8;n++)f=f<<1|1&i,g==e-1?(g=0,p.push(o(f)),f=0):g++,i>>=1}else{for(i=1,n=0;n<h;n++)f=f<<1|i,g==e-1?(g=0,p.push(o(f)),f=0):g++,i=0;for(i=l.charCodeAt(0),n=0;n<16;n++)f=f<<1|1&i,g==e-1?(g=0,p.push(o(f)),f=0):g++,i>>=1}0==--u&&(u=Math.pow(2,h),h++),delete c[l]}else for(i=s[l],n=0;n<h;n++)f=f<<1|1&i,g==e-1?(g=0,p.push(o(f)),f=0):g++,i>>=1;0==--u&&(u=Math.pow(2,h),h++)}for(i=2,n=0;n<h;n++)f=f<<1|1&i,g==e-1?(g=0,p.push(o(f)),f=0):g++,i>>=1;for(;;){if(f<<=1,g==e-1){p.push(o(f));break}g++}return p.join("")},decompress:function(e){return null==e?"":""==e?null:a._decompress(e.length,32768,function(t){return e.charCodeAt(t)})},_decompress:function(t,e,o){for(var n,i,r,a,s,c,l=[],u=4,d=4,h=3,p="",f=[],g={val:o(0),position:e,index:1},m=0;m<3;m+=1)l[m]=m;for(i=0,a=Math.pow(2,2),s=1;s!=a;)r=g.val&g.position,g.position>>=1,0==g.position&&(g.position=e,g.val=o(g.index++)),i|=(0<r?1:0)*s,s<<=1;switch(i){case 0:for(i=0,a=Math.pow(2,8),s=1;s!=a;)r=g.val&g.position,g.position>>=1,0==g.position&&(g.position=e,g.val=o(g.index++)),i|=(0<r?1:0)*s,s<<=1;c=w(i);break;case 1:for(i=0,a=Math.pow(2,16),s=1;s!=a;)r=g.val&g.position,g.position>>=1,0==g.position&&(g.position=e,g.val=o(g.index++)),i|=(0<r?1:0)*s,s<<=1;c=w(i);break;case 2:return""}for(n=l[3]=c,f.push(c);;){if(t<g.index)return"";for(i=0,a=Math.pow(2,h),s=1;s!=a;)r=g.val&g.position,g.position>>=1,0==g.position&&(g.position=e,g.val=o(g.index++)),i|=(0<r?1:0)*s,s<<=1;switch(c=i){case 0:for(i=0,a=Math.pow(2,8),s=1;s!=a;)r=g.val&g.position,g.position>>=1,0==g.position&&(g.position=e,g.val=o(g.index++)),i|=(0<r?1:0)*s,s<<=1;l[d++]=w(i),c=d-1,u--;break;case 1:for(i=0,a=Math.pow(2,16),s=1;s!=a;)r=g.val&g.position,g.position>>=1,0==g.position&&(g.position=e,g.val=o(g.index++)),i|=(0<r?1:0)*s,s<<=1;l[d++]=w(i),c=d-1,u--;break;case 2:return f.join("")}if(0==u&&(u=Math.pow(2,h),h++),l[c])p=l[c];else{if(c!==d)return null;p=n+n.charAt(0)}f.push(p),l[d++]=n+p.charAt(0),n=p,0==--u&&(u=Math.pow(2,h),h++)}}};function c(t,e){if(!r[t]){r[t]={};for(var o=0;o<t.length;o++)r[t][t.charAt(o)]=o}return r[t][e]}"function"==typeof define&&define.amd?define(function(){return s}):void 0!==e&&null!=e?e.exports=s:"undefined"!=typeof angular&&null!=angular&&angular.module("LZString",[]).factory("LZString",function(){return s})},{}],2:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=t("../common/bar/bar"),i=t("../common/pagination/pagination");o.default=function(){function t(){e.currentBook=JSON.parse(window.Store.get("currentBook")||'""'),"article"!==window.Router.current||e.currentBook||window.Router.go("bookshelf"),console.log(e.currentBook)}var e=this;this.element=document.querySelector(".page.article"),this.pagination=new i.default({root:this.element.querySelector(".content")}),this.bar=new n.default({element:this.element.querySelector(".bar"),pagination:this.pagination}),(window.Router.cbMap.article=t)()}},{"../common/bar/bar":6,"../common/pagination/pagination":13}],3:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=t("../common/bar/bar"),i=t("../common/common"),a=t("../common/pagination/pagination");function r(){var r=this;this.bookList=[],this.loading=!1,this.element=document.querySelector(".page.bookshelf"),this.pagination=new a.default({root:this.element.querySelector(".content")}),this.bar=new n.default({element:this.element.querySelector(".bar"),pagination:this.pagination}),this.bookList=JSON.parse(window.Store.get("bookshelf")||"[]"),this.currentBook=JSON.parse(window.Store.get("currentBook")||'""'),window.Bind.bindView(this.element.querySelector(".book-list"),this,"bookList",function(t){var e=r.element.querySelector(".pagination-box").offsetHeight/4,o=3*e/4,n=Math.floor(r.element.querySelector(".book-list").offsetWidth/2),i="\n                <style>\n                    .book-item {height: ".concat(e,"px;}\n                    .book-item .book-cover {width: ").concat(o,"px;}\n                    .book-item .book-info {width: ").concat(n-o-30,"px;}\n                </style>\n            ");return t.forEach(function(t){var e=new Date(t.latestChapterTime);i+='\n                    <div class="book-item" key="'.concat(t.name,"~!@#$%^&*").concat(t.author,'">\n                        <div class="book-cover" style="background-image: url(').concat(t.customCoverUrl,');">\n                            <img src="').concat(t.coverUrl,'" alt="').concat(t.name,'"/>\n                        </div>\n                        <div class="book-info">\n                            <div class="book-name">').concat(t.name,'</div>\n                            <div class="book-author">').concat(t.author,'</div>\n                            <div class="book-dur">').concat(t.durChapterTitle,'</div>\n                            <div class="book-latest">').concat(t.latestChapterTitle,'</div>\n                            <div class="book-latest-time">更新时间：').concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDay(),"</div>\n                        </div>\n                    </div>\n                ")}),window.setTimeout(function(){r.pagination.checkPage()}),i}),window.Router.cbMap.bookshelf=function(){r.bookList=[].concat(r.bookList)}}r.prototype.getBookShelf=function(){var e=this;!0===this.loading?window.Message.add({content:"正在加载书架数据"}):(this.loading=!0,window.Api.getBookshelf({success:function(t){e.loading=!1;t=t.data.map(function(t){return(0,i.getObject)(t,["name","author","bookUrl","coverUrl","customCoverUrl","durChapterIndex","durChapterPos","durChapterTime","durChapterTitle","latestChapterTime","latestChapterTitle"],{key:"".concat(t.name,"~!@#$%^&*").concat(t.author)})});e.bookList=[].concat(t).concat(t),window.Store.set("bookshelf",JSON.stringify(e.bookList))},error:function(t){e.loading=!1}}))},r.prototype.clickItem=function(t){var e=(0,i.getSpecialParent)(t.target||t.srcElement,function(t){return t.classList.contains("book-item")}).getAttribute("key").split("~!@#$%^&*");this.currentBook=this.bookList.filter(function(t){return t.name===e[0]&&t.author===e[1]})[0]||null,window.Store.set("currentBook",JSON.stringify(this.currentBook)),window.Router.go("article")},o.default=r},{"../common/bar/bar":6,"../common/common":8,"../common/pagination/pagination":13}],4:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=t("../common/bar/bar"),r=t("../common/pagination/pagination");function n(){function t(){n.currentBook=JSON.parse(window.Store.get("currentBook")||'""'),"article"!==window.Router.current||n.currentBook?(n.list=JSON.parse(window.Store.get("".concat(n.currentBook.name,"-").concat(n.currentBook.author,"-catalogue"))||"[]"),0===n.list.length&&n.getCatalogue()):window.Router.go("bookshelf")}var n=this;this.list=[],this.loading=!1,this.element=document.querySelector(".page.catalogue"),this.pagination=new r.default({root:this.element.querySelector(".content")}),this.bar=new i.default({element:this.element.querySelector(".bar"),pagination:this.pagination}),window.Bind.bindView(this.element.querySelector(".article-list"),this,"list",function(t){var e=n.element.querySelector(".pagination-box").offsetHeight,e=e/Math.round(e/80),o="\n                <style>\n                    .article-item {line-height: ".concat(e,"px;}\n                </style>\n            ");return t.forEach(function(t){o+='\n                    <div class="article-item" key="'.concat(t.index,'">').concat(t.title,"</div>\n                ")}),window.setTimeout(function(){n.pagination.checkPage()}),o});(window.Router.cbMap.catalogue=t)()}n.prototype.getCatalogue=function(){var e=this;!0===this.loading?window.Message.add({content:"正在加载书架数据"}):(this.loading=!0,window.Api.getCatalogue(this.currentBook.bookUrl,{success:function(t){e.loading=!1,e.list=t.data,window.Store.set("".concat(e.currentBook.name,"-").concat(e.currentBook.author,"-catalogue"),JSON.stringify(e.list))},error:function(t){e.loading=!1}}))},n.prototype.clickItem=function(t){console.log(t)},o.default=n},{"../common/bar/bar":6,"../common/pagination/pagination":13}],5:[function(t,e,o){"use strict";function n(){if(this.apiMap={bookshelf:"/getBookshelf",catalogue:"/getChapterList",article:"/getBookContent"},window.Api)throw Error("api has been inited");(window.Api=this).url=window.Store.get("url")||""}Object.defineProperty(o,"__esModule",{value:!0}),n.prototype.getCatalogue=function(t,e){this.get(this.url+this.apiMap.catalogue,{url:t},{success:function(t){e&&e.success&&e.success(t)},error:function(t){console.log(t),e&&e.error&&e.error(t),window.Message.add({content:"获取目录内容失败"})}})},n.prototype.getBookshelf=function(e){this.get(this.url+this.apiMap.bookshelf,{},{success:function(t){e&&e.success&&e.success(t)},error:function(t){console.log(t),e&&e.error&&e.error(t),window.Message.add({content:"获取书架内容失败"})}})},n.prototype.get=function(t,e,o){var n;if(this.url||o&&o.check)return(n=new XMLHttpRequest).open("GET","".concat(t,"?").concat(Object.keys(e).map(function(t){return"".concat(t,"=").concat(e[t])}).join("&"))),n.send(null),n.onreadystatechange=function(){if(4===this.readyState){var e=void 0;try{e=JSON.parse(this.responseText)}catch(t){e=this.responseText}200===this.status&&e.isSuccess?o&&o.success&&o.success(e):o&&o.error&&o.error(e)}},n;window.Message.add({content:"当前未配置服务器地址"}),o&&o.error&&o.error(null)},n.prototype.setUrl=function(t){this.url=t,window.Store.set("url",t)},n.prototype.checkUrl=function(e){var o=this;this._checkXHR&&this._checkXHR.abort(),this._checkXHR=this.get(e+this.apiMap.bookshelf,{},{success:function(t){window.Message.add({content:"服务器地址测试成功"}),o.setUrl(e)},error:function(t){console.log(t),window.Message.add({content:"服务器地址测试失败"})},check:!0})},o.default=n},{}],6:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(t){var o=this,t=(this.element=t.element,this.pagination=t.pagination,this.percent=0,this.element.innerHTML='\n                <div class="bar-progress"></div>\n                <div class="bar-text"><span class="bar-current"></span>/<span class="bar-total"></span></div>\n            ',this.element.querySelector(".bar-current")),e=this.element.querySelector(".bar-total"),n=this.element.querySelector(".bar-progress");window.Bind.bindView(t,this.pagination,"pageIndex",function(t){t+=1;return o.percent=t/o.pagination.pageLimit,t}),window.Bind.bindView(e,this.pagination,"pageLimit",function(t){return o.percent=(o.pagination.pageIndex+1)/t,t}),window.Bind.bindStyle(n,this,"percent","width",function(t){return"".concat(100*t,"%")}),this.element.onclick=function(t){var e=o.element.offsetWidth,t=t.pageX,t=Math.floor(o.pagination.pageLimit*t/e);o.pagination.setPage(t)}}},{}],7:[function(t,e,o){"use strict";function n(){if(this.cbMap={},this.objIndex=0,this.objMap={},window.Bind)throw Error("bind has been inited");window.Bind=this}Object.defineProperty(o,"__esModule",{value:!0}),n.prototype.handleObj=function(o,n){var i,r=this;o.hasOwnProperty("_bindId")||(o._bindId=this.objIndex++),this.cbMap[o._bindId+n]||(o[i="_"+n]=o[n],this.cbMap[o._bindId+n]=[],Object.defineProperty(o,n,{get:function(){return o[i]},set:function(t){var e=o[i];o[i]=t,r.run(o,n,t,e)}}))},n.prototype.bindInput=function(e,o,n){if(!e)throw new Error("element is null");this.bind(o,n,function(t){e.value=t},!0),e.onchange=function(t){o[n]=t.target.value}},n.prototype.bindStyle=function(e,t,o,n,i){if(!e)throw new Error("element is null");this.bind(t,o,function(t){e.style[n]=i?i(t):t},!0)},n.prototype.bindView=function(e,t,o,n){if(!e)throw new Error("element is null");this.bind(t,o,function(t){e.innerHTML=n?n(t):t},!0)},n.prototype.bind=function(t,e,o,n){this.handleObj(t,e),this.cbMap[t._bindId+e].push(o),n&&o(t[e])},n.prototype.run=function(t,e,o,n){this.cbMap[t._bindId+e].forEach(function(t){try{t(o,n)}catch(t){throw t}})},o.default=n},{}],8:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.getObject=o.getSpecialParent=o.makeDisplayText=o.strToDom=void 0,o.strToDom=function(t){var e=document.createElement("div");return e.innerHTML=t,e.children},o.makeDisplayText=function(t){return new Array(t+1).join("测试文本")},o.getSpecialParent=function t(e,o){return e&&e!==document&&o(e)?e:(e=e.parentElement||e.parentNode)?t(e,o):null},o.getObject=function(e,t,o){var n={};return t.forEach(function(t){n[t]=e[t]}),o&&Object.keys(o).forEach(function(t){n[t]=o[t]}),n}},{}],9:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){window.onerror=function(t){console.error(t),window.Modal&&window.Modal.add({content:t.toString()})}}},{}],10:[function(t,e,o){"use strict";function n(){if(this.limit={fontSize:20,lineHeight:24},this.base={fontSize:30,lineHeight:40},window.Layout)throw Error("layout has been inited");(window.Layout=this).fontSize=parseInt(window.Store.get("fontSize")||this.base.fontSize.toString()),this.lineHeight=parseInt(window.Store.get("lineHeight")||this.base.lineHeight.toString())}Object.defineProperty(o,"__esModule",{value:!0}),n.prototype.set=function(t,e){this[t]=e||this.base[t],window.Store.set(t,this[t].toString())},n.prototype.add=function(t,e){var o=this[t];(o+=e)<this.limit[t]&&(o=this.limit[t]),this.set(t,o)},n.prototype.reset=function(t){t?this.set(t):(this.set("fontSize"),this.set("lineHeight"))},o.default=n},{}],11:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=t("../common"),i=(r.prototype.remove=function(){var t=this.body.parentElement;t&&t.removeChild(this.body)},r);function r(t){var e=this,o=(0,n.strToDom)('\n            <div class="message">\n                <div class="message-content">\n                </div>\n            </div>\n        ')[0],o=(this.body=o).querySelector(".message-content");o.innerHTML=t.content,o.onclick=function(){t.onOk&&t.onOk(),e.remove()},t.banAutoRemove||window.setTimeout(function(){t.onCancle&&t.onCancle(),e.remove()},2e3)}function a(){if(window.Message)throw Error("modal has been inited");this.list=[],(window.Message=this).element=document.querySelector(".message-box")}a.prototype.add=function(t){t=new i(t);return this.list.push(t),this.element.appendChild(t.body),t},a.prototype.remove=function(t){t.remove();t=this.list.indexOf(t);this.list.splice(t,1)},a.prototype.clear=function(){this.list=[],this.element.innerHTML=""},o.default=a},{"../common":8}],12:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t("../common"),n=(i.prototype.remove=function(){this.body.parentElement.removeChild(this.body)},i);function i(t){var e=this,o=(this.zIndex=t.zIndex,'\n            <div class="modal" style="z-index: '.concat(this.zIndex,';">\n                <div class="modal-content">\n                </div>\n                <div class="modal-footer">\n                    <div class="button modal-confirm">确定</div>\n                    <div class="button modal-cancel">取消</div>\n                </div>\n            </div>\n        ')),o=(0,r.strToDom)(o)[0],n=(this.body=o).querySelector(".modal-content"),i=o.querySelector(".modal-confirm"),o=o.querySelector(".modal-cancel");"string"==typeof t.content?n.innerHTML=t.content:n.appendChild(t.content),o.onclick=function(){t.onCancel&&t.onCancel(),e.remove()},i.onclick=function(){t.onOk&&t.onOk(),e.remove()}}function a(){if(this.list=[],window.Modal)throw Error("modal has been inited");(window.Modal=this).element=document.querySelector(".modal-box")}a.prototype.add=function(t){"zIndex"in t||(e=this.list.length,t.zIndex=(e?this.list[e-1].zIndex:100)+1);var e=new n(t);return this.list.push(e),this.element.appendChild(e.body),e},a.prototype.remove=function(t){t.remove();t=this.list.indexOf(t);this.list.splice(t,1)},a.prototype.clear=function(){this.list=[],this.element.innerHTML=""},o.default=a},{"../common":8}],13:[function(t,e,o){"use strict";function n(t){var e=this;this.pageIndex=0,this.pageLimit=1,this.pagePadding=0,this.root=t.root,this.handleHtml(t.root),this.pageStep=this.box.offsetHeight,this.checkPage(),window.Bind.bindStyle(this.padding,this,"pagePadding","height",function(t){return"".concat(t,"px")}),window.Bind.bind(this,"pageIndex",function(t){e.box.scrollTop=e.pageStep*t})}Object.defineProperty(o,"__esModule",{value:!0}),n.prototype.handleHtml=function(t){var e=t.innerHTML;t.innerHTML='\n            <div class="pagination-box">\n                <div class="pagination-body">\n                    <div class="pagination-content"></div>\n                    <div class="pagination-padding"></div>\n                </div>\n            </div>',t.querySelector(".pagination-content").innerHTML=e,this.box=t.querySelector(".pagination-box"),this.padding=t.querySelector(".pagination-padding")},n.prototype.checkPage=function(){this.pageStep=this.box.offsetHeight,this.pageLimit=Math.ceil(this.box.scrollHeight/this.pageStep)||1,this.pagePadding=this.pageStep*this.pageLimit-this.box.scrollHeight},n.prototype.setPage=function(t){var e=t<0?0:t;t>=this.pageLimit&&(e=this.pageLimit-1),this.pageIndex=e},n.prototype.pageChange=function(t){this.setPage(this.pageIndex+t)},o.default=n},{}],14:[function(t,e,o){"use strict";function n(t){var n=this;if(this.pages=[],this.cbMap={},window.Router)throw Error("router has been inited");(window.Router=this).pages=t;function e(t){var e=window.location.hash,o=e.lastIndexOf("#");-1<o&&(e=e.slice(o+1)),0!==n.pages.length&&(-1===n.pages.indexOf(e)?window.location.hash=n.pages[0]:n.switchPage(e))}(window.onhashchange=e)()}Object.defineProperty(o,"__esModule",{value:!0}),n.prototype.switchPage=function(t){var e;null!=(e=document.querySelector(".show"))&&e.classList.remove("show"),null!=(e=document.querySelector(".".concat(t)))&&e.classList.add("show"),this.current=t,this.cbMap[t]&&this.cbMap[t]()},n.prototype.go=function(t){window.location.hash=t},o.default=n},{}],15:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=t("lz-string");function n(){if(this.limitChecking=!1,this.limit=0,this.usage=0,window.Store)throw Error("store has been inited");(window.Store=this).limit=parseInt(this.get("limit")||"0"),this.checkUsage(),0===this.limit&&window.Message.add({content:"缓存未初始化请手动检测"})}n.prototype.set=function(t,e,o){try{var n=r.compress(t),i=r.compress(e);localStorage.setItem(n,i),this.checkUsage(),o&&o.success&&o.success()}catch(t){window.Message.add({content:"缓存失败，空间不足"}),o&&o.fail&&o.fail()}},n.prototype.get=function(t){t=localStorage.getItem(r.compress(t));return t?r.decompress(t):null},n.prototype.checkUsage=function(){this.usage=Object.keys(localStorage).map(function(t){return t+localStorage.getItem(t)}).join("").length},n.prototype.checkLimit=function(){var i=this;window.Message.add({content:"正在检测缓存容量"}),this.limitChecking||(this.limitChecking=!0,window.setTimeout(function(){for(var t=i.usage,e=1e6,o=0;2<e;)try{var n="_test".concat(o++);if(e<n.length)break;localStorage.setItem(n,new Array(e-n.length+1).join("a")),t+=e}catch(t){console.log(t),o--,e=Math.round(e/2)}i.limit=t,Object.keys(localStorage).filter(function(t){return 0===t.indexOf("_test")}).forEach(function(t){return localStorage.removeItem(t)}),i.set("limit",i.limit.toString()),i.limitChecking=!1,window.Message.add({content:"检测完成"})},1e3))},o.default=n},{"lz-string":1}],16:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=t("../common/common");function i(){this.element=document.querySelector(".page.config"),this.url=window.Api.url,this.displayText=(0,n.makeDisplayText)(200),window.Bind.bindInput(this.element.querySelector(".url input"),this,"url"),window.Bind.bindView(this.element.querySelector(".store-usage"),window.Store,"usage"),window.Bind.bindView(this.element.querySelector(".store-total"),window.Store,"limit"),window.Bind.bindView(this.element.querySelector(".font-size"),window.Layout,"fontSize"),window.Bind.bindView(this.element.querySelector(".line-height"),window.Layout,"lineHeight");var t=this.element.querySelector(".display .text p");window.Bind.bindView(t,this,"displayText"),window.Bind.bindStyle(t,window.Layout,"fontSize","fontSize",function(t){return"".concat(t,"px")}),window.Bind.bindStyle(t,window.Layout,"lineHeight","lineHeight",function(t){return"".concat(t,"px")}),this.url?this.checkUrl():window.Message.add({content:"当前未配置服务器地址"})}i.prototype.checkUrl=function(){window.Api.checkUrl(this.url)},o.default=i},{"../common/common":8}],17:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=t("./bookshelf/bookshelf"),i=t("./config/config"),r=t("./common/router/router"),a=t("./common/debugger/debugger"),s=t("./common/modal/modal"),c=t("./common/message/message"),l=t("./common/store/store"),u=t("./common/bind/bind"),d=t("./common/layout/layout"),h=t("./common/api/api"),p=t("./article/article"),f=t("./catalogue/catalogue"),g=["config","bookshelf","article","catalogue"];window.init=function(){new a.default,new u.default,new s.default,new c.default,new r.default(g),new l.default,new d.default,new h.default,document.querySelector(".global-style").innerHTML="\n        <style>\n            .page .content {\n                height: ".concat(document.body.offsetHeight-230,"px;\n            }\n        </style>\n    "),window.Config=new i.default,window.BookShelf=new n.default,window.Article=new p.default,window.Catalogue=new f.default},window.ondblclick=function(t){t.preventDefault()}},{"./article/article":2,"./bookshelf/bookshelf":3,"./catalogue/catalogue":4,"./common/api/api":5,"./common/bind/bind":7,"./common/debugger/debugger":9,"./common/layout/layout":10,"./common/message/message":11,"./common/modal/modal":12,"./common/router/router":14,"./common/store/store":15,"./config/config":16}]},{},[17]);</script>
    <!-- endinject -->
</head>

<body onload="init()">
    <div class="global-style"></div>
    <div class="page bookshelf show">
        <div class="content">
            <div class="book-list" onclick="BookShelf.clickItem(event)"></div>
        </div>
        <div class="bar"></div>
        <div class="control">
            <div class="left-box">
                <div class="button" onclick="Router.go('config')">配置</div>
                <div class="button" onclick="BookShelf.getBookShelf()">刷新</div>
            </div>
            <div class="right-box">
                <div class="button" onclick="BookShelf.pagination.pageChange(-1)">&lt;</div>
                <div class="button" onclick="BookShelf.pagination.pageChange(1)">&gt;</div>
            </div>
        </div>
    </div>
    <div class="page article">
        <div class="content">article</div>
        <div class="bar"></div>
        <div class="control">
            <div class="left-box">
                <div class="button" onclick="Router.go('bookshelf')">书架</div>
                <div class="button" onclick="Router.go('catalogue')">目录</div>
                <div class="button">刷新</div>
            </div>
            <div class="right-box">
                <div class="button" onclick="Article.pagination.pageChange(-1)">&lt;</div>
                <div class="button" onclick="Article.pagination.pageChange(1)">&gt;</div>
            </div>
        </div>
    </div>
    <div class="page catalogue">
        <div class="content">
            <div class="article-list" onclick="Catalogue.clickItem(event)"></div>
        </div>
        <div class="bar"></div>
        <div class="control">
            <div class="left-box">
                <div class="button" onclick="Router.go('bookshelf')">书架</div>
                <div class="button" onclick="Router.go('article')">文章</div>
                <div class="button" onclick="Catalogue.getCatalogue()">刷新</div>
            </div>
            <div class="right-box">
                <div class="button" onclick="Catalogue.pagination.pageChange(-1)">&lt;</div>
                <div class="button" onclick="Catalogue.pagination.pageChange(1)">&gt;</div>
            </div>
        </div>
    </div>
    <div class="page config">
        <div class="content">
            <div class="form-item url">
                <div class="label">服务器地址</div>
                <div class="text">
                    <input type="text" placeholder="请输入阅读服务地址"/>
                    <div class="button right" onclick="Config.checkUrl()">测试</div>
                </div>
            </div>
            <div class="form-item">
                <div class="label">缓存容量</div>
                <div class="text">
                    <span class="store-usage">-</span>
                    <span class="store-division">/</span>
                    <span class="store-total">-</span>
                    <span class="store-percent"></span>
                    <div class="button right" onclick="Store.checkLimit()">检测</div>
                </div>
            </div>
            <div class="form-item">
                <div class="label">字号</div>
                <div class="text">
                    <span class="font-size">16</span>
                    <span class="font-unit">px</span>
                    <div class="button right" onclick="Layout.reset('fontSize')">重置</div>
                    <div class="button right" onclick="Layout.add('fontSize', -1)">-</div>
                    <div class="button right" onclick="Layout.add('fontSize', 1)">+</div>
                </div>
            </div>
            <div class="form-item">
                <div class="label">行距</div>
                <div class="text">
                    <span class="line-height">20</span>
                    <span class="line-unit">px</span>
                    <div class="button right" onclick="Layout.reset('lineHeight')">重置</div>
                    <div class="button right" onclick="Layout.add('lineHeight', -1)">-</div>
                    <div class="button right" onclick="Layout.add('lineHeight', 1)">+</div>
                </div>
            </div>
            <div class="form-item display">
                <div class="label">效果展示</div>
                <div class="text">
                    <p>测试文本</p>
                </div>
            </div>
        </div>
        <div class="control">
            <div class="left-box">
                <div class="button" onclick="Router.go('bookshelf')">书架</div>
            </div>
            <div class="right-box">
                <!-- <div class="button" onclick="">保存</div> -->
            </div>
        </div>
    </div>

    <div class="modal-box"></div>
    <div class="message-box"></div>
</body>

</html>